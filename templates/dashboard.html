{{template "header.html" .}}
<script src="https://unpkg.com/htmx.org@1.9.10"></script>

<style>
    .text-truncate {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .card {
        border-radius: 0.5rem;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .card:hover {
        transform: scale(1.05);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }    

    .loading-spinner {
        display: none;
    }

    .loading .loading-spinner {
        display: inline-block;
    }
</style>

<div class="container mt-4">
    {{if .error}}
    <div class="alert alert-danger">
        {{.error}}
    </div>
    {{end}}
    {{if .success}}
    <div class="alert alert-success">
        {{.success}}
    </div>
    {{end}}

    <div class="d-flex justify-content-between align-items-center">
        <h1 class="mb-4">Event Dashboard</h1>
        <a href="/events/new" class="btn btn-primary btn-lg">+ Create New Event</a>
    </div>

    <div id="eventContainer" class="row row-cols-1 row-cols-md-4 g-4">
        {{template "event_cards.html" .}}
    </div>

    {{if .hasMore}}
    <div class="text-center mt-4">
        <button 
            id="loadMore" 
            class="btn btn-outline-secondary"
            hx-get="/dashboard?page={{.nextPage}}"
            hx-trigger="click"
            hx-target="#eventContainer"
            hx-swap="beforeend"
            hx-indicator="#loadingSpinner">
            Load More
            <span id="loadingSpinner" class="loading-spinner spinner-border spinner-border-sm ms-2" role="status">
                <span class="visually-hidden">Loading...</span>
            </span>
        </button>
    </div>
    {{end}}
</div>

{{template "footer.html" .}}